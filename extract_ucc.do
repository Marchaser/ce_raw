// extract UCC
forval year=1984/2013{
forval quarter=1/5{
	cap use e\e`year'q`quarter', clear
	collapse (count)NEWID, by(UCC)
	
	save u/u`year'q`quarter', replace
}
}


// append all ucc
clear
forval year=1984/2013{
forval quarter=1/5{
	append using u/u`year'q`quarter'
	gen inY`year'Q`quarter' = 1
}
}

collapse (max)inY*, by(UCC)
save u/uall,replace

// appply official classification to ucc
clear 
use u/uall, clear
/****************** 1984 **************************/
gen FOOD=1 if inlist(UCC,790410, 790430, 800700) | inrange(UCC,190901,190904) | inrange(UCC,790220,790230)
gen ALCBEV=1 if inlist(UCC,200900, 790310, 790320, 790420)
gen HOUS=1 if 0 | inrange(UCC,210110,220322) | inrange(UCC,220901,270214) | inrange(UCC,270411,300412) | inrange(UCC,320110,340530) | inrange(UCC,340620,340901) | inrange(UCC,340903,340904) | inrange(UCC,340906,350110) | inlist(UCC,430130) | inlist(UCC,670310) | inrange(UCC,690110,690245) | inlist(UCC,790600) | inlist(UCC,790690) | inrange(UCC,990900,990950) | inlist(UCC,800710)
gen SHELT=1 if 0 | inrange(UCC,210110,220322) | inrange(UCC,220901,230116) | inrange(UCC,230119,230123) | inrange(UCC,230141,240323) | inrange(UCC,320611,320633) | inrange(UCC,340911,350110) | inrange(UCC,690241,690245) | inlist(UCC,800710) | inlist(UCC,790600) | inlist(UCC,790690) | inrange(UCC,990910,990950)
gen OWNDWE=1 if 0 | inlist(UCC,220311,220321,220211,230901,340911,220121,220111,210901) | inrange(UCC,230112,230116) | inlist(UCC,230122,230142,240112,240122,240312,240322,320622) | inrange(UCC,240212,240213) | inlist(UCC,240222,320632,690242,690245,320612,990930)
gen RENDWE=1 if 0 | inlist(UCC,230111,230121,230141,350110,240111,240121,240211,240221,240311,240321,690241,690244,320611) | inrange(UCC,990910,990920) | inlist(UCC,790690,320621,320631,220901,210110,990950,800710)
gen OTHLOD=1 if 0 | inlist(UCC,220212,220122,220112,210902,230119,230123,240113,240123,240214,240223,240313,240323,690243,320613,990940,320623,320633,230902,340912,220902,790600,220322,220312,210310,210210)
gen UTIL=1 if 0 | inrange(UCC,250111,270214) | inrange(UCC,270411,270904)
gen HOUSOP=1 if 0 | inlist(UCC,330511) | inrange(UCC,340210,340530) | inrange(UCC,340620,340901) | inlist(UCC,990900) | inrange(UCC,340906,340908) | inlist(UCC,670310,340903)
gen HOUSEQ=1 if 0 | inrange(UCC,280110,300412) | inrange(UCC,230131,230132) | inrange(UCC,320110,320522) | inrange(UCC,230117,230118) | inlist(UCC,340904) | inrange(UCC,690110,690230) | inlist(UCC,430130) | inrange(UCC,320901,320904)
gen APPAR=1 if 0 | inrange(UCC,360110,430120) | inrange(UCC,440110,440900)
gen TRANS=1 if 0 | inrange(UCC,460901,460903) | inlist(UCC,450110,450210,460110,450220) | inrange(UCC,470111,470212) | inlist(UCC,450900,620902) | inrange(UCC,470220,530902) | inrange(UCC,620906,620907) | inlist(UCC,850300)
gen VEHICL=1 if 0 | inlist(UCC,450110,450210,460110,460901,450220) | inrange(UCC,460902,460902)
gen GASMO=1 if 0 | inrange(UCC,470111,470212)
gen OTHVEH=1 if 0 | inrange(UCC,470220,490900) | inrange(UCC,510110,510902) | inlist(UCC,850300) | inrange(UCC,470220,490900) | inrange(UCC,510110,510902) | inlist(UCC,500110) | inrange(UCC,520110,520907) | inrange(UCC,620906,620907) | inlist(UCC,620902,850300)
gen PUBTRA=1 if 0 | inrange(UCC,530110,530902)
gen HEALTH=1 if 0 | inrange(UCC,540000,580902)
gen ENTERT=1 if 0 | inlist(UCC,340902) | inrange(UCC,310110,310342) | inlist(UCC,340610,270310,340905) | inrange(UCC,600210,620420) | inrange(UCC,620908,620912) | inrange(UCC,620903,620905) | inrange(UCC,600110,600122) | inrange(UCC,600131,600132)
gen PERSCA=1 if 0 | inrange(UCC,640130,650900)
gen READ=1 if 0 | inrange(UCC,590110,590230) | inlist(UCC,660310)
gen EDUCA=1 if 0 | inrange(UCC,670901,670902) | inrange(UCC,660110,660210) | inrange(UCC,660900,670210)
gen TOBACC=1 if 0 | inrange(UCC,630110,630210)
gen MISC=1 if 0 | inrange(UCC,680110,680902) | inlist(UCC,710110,900001)
gen CASHCO=1 if 0 | inlist(UCC,800801) | inrange(UCC,800810,800860)
gen PERINS=1 if 0 | inlist(UCC,700110,002120) | inrange(UCC,800910,800940)
gen LIFINS=1 if 0 | inlist(UCC,700110,002120)
gen RETPEN=1 if 0 | inrange(UCC,800910,800940)

/**************** 1989 ****************/
gen FDHOME=1 if 0 | inlist(UCC,790220,790230,190904)
gen FDAWAY=1 if 0 | inrange(UCC,190901,190903) | inlist(UCC,790410,800700,790430)

/******************** 2012 ********************/
// FOOD
gen FDXMAP=1 if 0 | inlist(UCC,190901,190902,190903,790410,790430)
gen FDMAP=1 if 0 | inlist(UCC,800700)
gen FDAWAY=1 if FDXMAP | FDMAP
gen FOOD=1 if FDHOME | FDAWAY

// ALCBEV
gen ALCBEV=1 if inlist(UCC,200900, 790310, 790320, 790420)

// HOUS
gen MRTINT=1 if 0 | inlist(UCC,220311,220321,220313,880110)
gen PROPT=1 if 0 | inlist(UCC,220211)
gen MRPINS=1 if 0 | inlist(UCC,210901,220111,220121,220901,230112,230113,230114,230115,230122,230142,230151,230901,240112,240122,240212,240213,240222,240312,240322,320612,320622,320632,340911,990930,230116)
gen 

gen RNTXRP=1 if 0 | inlist(UCC,210110,230121,230141,230150,240111,240121,240211,240221,240311,240321,320611,320621,320631,350110,790690,990910,990920,230111)
gen RNTAPY=1 if 0 | inlist(UCC,800710)


gen NTLGAS=1 if 0 | inlist(UCC,260211,260212,260213,260214)
gen ELCTRC=1 if 0 | inlist(UCC,260111,260112,260113,260114)
gen FULOIL=1 if 0 | inlist(UCC,250111,250112,250113,250114)
gen OTHFLS=1 if 0 | inlist(UCC,250211,250212,250213,250214,250221,250222,250223,250224,250901,250902,250903,250904)
gen ALLFUL=1 if FULOIL | OTHFLS
gen TELEPH=1 if 0 | inlist(UCC,270101,270102)
gen WATRPS=1 if 0 | inlist(UCC,270211,270212,270213,270214,270411,270412,270413,270414,270901,270902,270903,270904)
// gen UTIL=NTLGAS | ELCTRC | ALLFUL | TELEPH | WATRPS

gen DMSXCC=1 if 0 | inlist(UCC,340310,340410,340420,340520,340530,340903,340906,340914)
gen BBYDAY=1 if 0 | inlist(UCC,340211,340212,670310)
gen DOMSRV=1 if DMSXCC | BBYDAY
gen OTHHE=1 if 0 | inlist(UCC,330511,340510,340620,340630,340901,340907,340908,690113,990900)
// gen HOUSOP=1 if DOMSRV | OTHHEX

gen TEXTIL=1 if 0 | inlist(UCC,280110,280120,280130,280210,280220,280230,280900)
gen FURNTR=1 if 0 | inlist(UCC,290110,290120,290210,290310,290320,290410,290420,290430,290440)
gen FLRCVR=1 if 0 | inlist(UCC,230131,230132,320110,320161,320162)
gen MAJAPP=1 if 0 | inlist(UCC,230117,230118,300111,300112,300211,300212,300221,300222,300311,300312,300321,300322,300331,300332,300411,300412,320511,320512)
gen SMLAPP=1 if 0 | inlist(UCC,320310,320320,320330,320340,320350,320360,320370,320521,320522)
gen MISCEQ=1 if 0 | inlist(UCC,320120,320130,320150,320210,320220,320231,320232,320410,320420,320901,320902,320903,320904,340904,430130,690111,690112,690210,690220,690230,690241,690242,690243,690244,690245)
// gen HOUSEQ=1 if TEXTIL | FURNTR | FLRCVR | MAJAPP | SMLAPP | MISCEQ

gen MENSI=1 if 0 | inlist(UCC,360110,360120,360210,360311,360312,360320,360330,360340,360350,360410,360511,360512,360901,360902)
gen BOYFIF=1 if 0 | inlist(UCC,370110,370120,370130,370211,370212,370213,370220,370311,370312,370313,370901,370902)
gen MENBOY if MENSIX | BOYFIF
gen WOMSIX=1 if 0 | inlist(UCC,380110,380210,380311,380312,380313,380320,380331,380332,380340,380410,380420,380430,380510,380901,380902,380903)
gen GRLFIF=1 if 0 | inlist(UCC,390110,390120,390210,390221,390222,390230,390310,390321,390322,390901,390902)
gen WOMGRL=1 if WOMSIX | GRLFIF
gen CHLDRN=1 if 0 | inlist(UCC,410110,410120,410130,410140,410901)
gen FOOTWR=1 if 0 | inlist(UCC,400110,400210,400220,400310)
gen OTHAPL=1 if 0 | inlist(UCC,420110,420120,430110,430120,440110,440120,440130,440140,440150,440210,440900)
// gen APPAR=1 if MENBOY | WOMGRL | CHLDRN | FOOTWR | OTHAPL

gen CARTKN=1 if 0 | inlist(UCC,450110,450210)
gen CARTKU=1 if 0 | inlist(UCC,460110,460901)
gen VEHFIN=1 if 0 | inlist(UCC,510110,510901,510902,850300)
gen MAINRP=1 if 0 | inlist(UCC,470220,480110,480213,480214,490110,490211,490212,490220,490231,490232,490311,490312,490313,490314,490315,490318,490319,490411,490412,490413,490501,490502,490900,480211,490500)
gen VEHINS=1 if 0 | inlist(UCC,500110)
gen VRNTLO=1 if 0 | inlist(UCC,450310,450313,450314,450410,450413,450414,520110,520310,520410,520511,520512,520521,520522,520531,520532,520542,520550,520902,520903,520905,520906,620113)
gen TRNTRP=1 if 0 | inlist(UCC,530110,530210,530312,530411,530510,530901)
gen TRNOTH=1 if 0 | inlist(UCC,530311,530412,530902)
gen PUBTRA=1 if TRNTRP | TRNOTH
// gen TRANS=1 if CARTKN | CARTKU | OTHVEH | GASMO | VEHFIN | MAINRP | VEHINS | VRNTLO | PUBTRA

gen HLTHIN=1 if 0 | inlist(UCC,580110,580210,580310,580901,580902)
gen MEDSRV=1 if 0 | inlist(UCC,560110,560210,560310,560330,560400,570110,570210,570220,570230,570240)
gen PREDRG=1 if 0 | inlist(UCC,540000)
gen MEDSUP=1 if 0 | inlist(UCC,550110,550320,550330,550340,570901,570903)
// gen HEALTH=1 if HLTHIN | MEDSRV | PREDRG | MEDSUP

gen FEEADM=1 if 0 | inlist(UCC,610900,620111,620121,620122,620211,620212,620221,620222,620310,620903)
gen TVRDIO=1 if 0 | inlist(UCC,270310,310110,310120,310130,310210,310220,310230,310311,310312,310313,310320,310330,310341,310342,340610,340902,340905,610130,620904,620912)
gen PETTOY=1 if 0 | inlist(UCC,610110,610120,610320,620410,620420)
gen OTHENT=1 if 0 | inlist(UCC,520901,520904,520907,600110,600121,600122,600132,600141,600142,600210,600310,600410,600420,600430,600901,600902,610210,610230,620330,620905,620906,620908,620909,620919,620921,620922,600131,600900,620907)
gen OTHEQP=1 if PETTOY | OTHENT
// gen ENTERT=1 if FEEADM | TVRDIO | OTHEQP




egen hasClass = rowmax(*)
bro if inY1984Q1==1 & hasClass~=1

